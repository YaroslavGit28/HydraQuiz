# ОТЧЕТ о проекте "HydraQuiz"

## 1. Назначение и общая структура

**HydraQuiz** — это приложение-викторина, разработанное на C# с использованием Windows Forms. Оно позволяет пользователям проходить тематические тесты, видеть свои результаты, просматривать историю попыток и лучших игроков. Все данные хранятся локально (JSON и SQLite).

**Структура проекта:**
- `QuizApp.WinForms/` — основной проект (код, формы, модели, сервисы)
- `QuizApp.WinForms.Tests/` — модульные тесты
- `questions.json` — база вопросов
- `quiz_results.db` — база результатов (SQLite)

## 2. Основные возможности
- Выбор группы и темы викторины
- Ввод имени игрока
- Прохождение теста с вариантами ответов
- Подсчет и отображение результатов (баллы, %)
- Сохранение результатов в базу данных
- Просмотр истории попыток
- Просмотр таблицы лидеров
- Переключение светлой/темной темы
- Разбор ответов после викторины

## 3. Архитектура и логика работы

### 3.1. Главная форма (`Form1`)
- Загружает вопросы из `questions.json` через `QuizDataService`
- Позволяет выбрать группу и тему (например, "Авто", "Игры", "Вещи")
- После старта викторины отображает вопросы и варианты ответов
- Сохраняет ответы пользователя, считает баллы
- После завершения — показывает результат, сохраняет его в SQLite через `QuizResultsDbService`
- Позволяет открыть историю, лидеров, статистику, обзор ответов
- Поддерживает смену темы оформления через `ThemeManager`

### 3.2. Модели данных
- **Question** — вопрос, варианты, правильный ответ, категория, группа
- **QuizResult** — результат попытки (имя, баллы, дата, время)
- **QuizResultDbModel** — результат для хранения в БД (доп. поля: тема, %)
- **LeaderBoardUser** — пользователь для таблицы лидеров (имя, средний %, попытки)
- **UserBestResult** — лучший результат пользователя
- **UserHistoryResult** — история попыток пользователя

### 3.3. Сервисы
- **QuizDataService** — загрузка/сохранение вопросов и результатов в JSON
- **QuizResultsDbService** — работа с SQLite: добавление, выборка, удаление результатов, получение лидеров и истории

### 3.4. Темы оформления
- **ThemeManager** и **ThemeColors** — реализуют светлую и темную тему для всех элементов интерфейса

### 3.5. Дополнительные формы
- **LeadersForm** — отображает топ-10 пользователей по среднему проценту
- **HistoryForm** — показывает историю попыток выбранного игрока
- **ReviewForm** — позволяет просмотреть свои ответы и правильные после викторины

## 4. Структура данных

### 4.1. Вопросы (questions.json)
```json
{
  "Text": "Столица Франции?",
  "Answers": ["Париж", "Берлин", "Лондон", "Мадрид"],
  "CorrectAnswerIndex": 0,
  "Category": "География",
  "Group": "Предметы школы"
}
```

### 4.2. Результаты (SQLite)
- Таблица `QuizResults`:
  - Id, UserName, Theme, Score, TotalQuestions, Percentage, CompletedDate

## 5. Технологии
- **.NET 9.0**
- **C#**
- **Windows Forms**
- **Microsoft.Data.Sqlite** (SQLite)
- **System.Text.Json** (JSON)
- **NUnit** (тесты)

## 6. Тестирование
- Все основные сервисы покрыты модульными тестами (`QuizApp.WinForms.Tests`)
- Проверяется корректность загрузки/сохранения вопросов и результатов, работа с БД, удаление данных
- Для тестов используются временные файлы и отдельная БД
- Запуск: `dotnet test`

## 7. Как работает приложение (кратко)
1. При запуске загружаются вопросы и темы
2. Пользователь выбирает группу, тему, вводит имя
3. Проходит викторину, выбирая ответы
4. После завершения — видит результат, может просмотреть разбор, историю, лидеров
5. Все результаты сохраняются в SQLite, история доступна по имени игрока
6. Можно переключать тему оформления

## 8. Пример сценария использования
1. Открыть приложение
2. Ввести имя, выбрать группу и тему
3. Ответить на вопросы
4. Посмотреть результат и разбор
5. Открыть историю или таблицу лидеров

## 9. Рекомендации для защиты
- Покажите запуск, выбор темы, прохождение теста, просмотр истории и лидеров
- Объясните, как хранятся вопросы и результаты
- Покажите смену темы оформления
- Расскажите о тестах и надежности хранения данных

---

**Проект готов к демонстрации и защите!** 